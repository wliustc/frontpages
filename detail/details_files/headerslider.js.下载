function HeaderSlider(a){this.p=a;this.oDiv=document.querySelector(a);this.oUl=document.querySelector(".header-slider-con");this.aLi=document.querySelectorAll(".header-slider-item");this.aTabTitle=document.querySelectorAll(".header-tab-title");this.aTabLi=document.querySelectorAll(".header-tab-item");this.oMCommonHeader=document.getElementById("m_common_header");this.oSiftTab=document.querySelector(".sift-tab");this.oTabs=document.getElementById("tabs");this.oTryme=document.querySelector(".tryme");this.oDownloadApp=document.querySelector(".download-pannel");this.oBox={startX:0,startY:0,finalX:0,finalY:0,endX:0,endY:0,sliderX:0,moveX:0,tabIndex:0,numTime:0,isMove:false,startTime:0,moveTime:0}}HeaderSlider.prototype={init:function(b){var b=b||{},d=this.aLi,a=this.oDiv,c=this;this.setHeightTimer=null;this.clearHeightTimer=null;this.aLiLen=d.length;this.oDivWidth=a.offsetWidth;this.oUserAgent=window.navigator.userAgent;this.defaults={loadInfoFn:false,loadAssessFn:false};HeaderSlider.extend(this.defaults,b);this.liInit();this.bind();clearInterval(this.setHeightTimer);this.setHeightTimer=setInterval(function(){c.setHeight()},800);clearTimeout(this.clearHeightTimer);this.clearHeightTimer=setTimeout(function(){clearInterval(c.setHeightTimer)},10000);this.setHoldTopHeight()},liInit:function(){var f=this.aLi,c=this.oDiv,b=this.oUl,d=this.aLiLen,e=document.querySelector(".jd-header");clearTimeout(a);var a=setTimeout(function(){var k=document.documentElement.clientWidth;var g=document.documentElement.clientHeight;for(var j=0;j<d;j++){f[j].style.width=k+"px";f[j].style.height=g+"px"}this.aLiWidth=f[0].offsetWidth;var h=this.aLiWidth*d;b.style.width=h+"px";if(e!=null){e.style.width=k+"px"}c.style.width=k+"px"},300)},bind:function(){var c=this.oDiv,d=this.oMCommonHeader,f=this.oUserAgent,e=document.querySelector("#commentListId"),b="onorientationchange" in window,a=b?"orientationchange":"resize";if(f.indexOf("iPhone")!=-1){c.addEventListener("touchstart",this,false)}window.addEventListener(a,this,false);this.appClick();this.foldClick();this.guessSwitch();this.evaluateJump();if(e){this.assessScroll()}if(d!=null){this.clickTab();this.windowScroll();this.oJdkeyClick();this.clickInfoTab();this.clickAssessTab();this.toTop()}},setHeight:function(){var a=this.aLi,h=this.oUl,d=this.oBox,c=0,i=document.querySelector(".hold-div-top").offsetHeight,f=document.querySelector(".hold-div-bottom").offsetHeight,b=document.querySelector(".cart-concern-btm-fixed");if(b){c=b.offsetHeight}else{c=0}var g=document.documentElement.clientHeight;var e=g-i-f-c;if(!HeaderSlider.hasClass(a[d.tabIndex],"reply-body")){a[d.tabIndex].style.height="auto";if(a[d.tabIndex].offsetHeight>e){a[d.tabIndex].style.height=a[d.tabIndex].offsetHeight+"px"}else{a[d.tabIndex].style.height=e+"px"}}if(a[d.tabIndex].offsetHeight>e){h.style.height=a[d.tabIndex].offsetHeight+"px"}else{h.style.height=e+"px"}},setHoldTopHeight:function(){var a=document.querySelector(".hold-div-top"),c=document.querySelector(".m_common_new_top");if(c!=null){var b=c.offsetHeight;a.style.height=b+"px"}},handleEvent:function(a){switch(a.type){case"touchstart":this.startHandle(a);break;case"touchmove":this.moveHandle(a);break;case"touchend":this.endHandle(a);break;case"orientationchange":this.orientationchangeHandler(a);break;case"resize":this.orientationchangeHandler(a);break}},startHandle:function(d){d.stopPropagation();var c=d.targetTouches[0],a=this.oUl,b=this.oDiv,f=this.oBox;f.numTime=0;f.startX=c.pageX;f.startY=c.pageY;f.isMove=false;f.startTime=new Date().getTime();HeaderSlider.setStyle(a,{WebkitTransition:"",transition:""});b.addEventListener("touchmove",this,false);b.addEventListener("touchend",this,false)},moveHandle:function(g){g.stopPropagation();var f=g.targetTouches[0],i=this.oBox,b=this.oUl,c,a;i.moveTime=new Date().getTime();if((i.moveTime-i.startTime)>=50){if(i.numTime===0){i.finalX=f.pageX;i.finalY=f.pageY;c=HeaderSlider.getAngle(i.startX,i.finalX,i.startY,i.finalY);a=HeaderSlider.getSpeed(i.startX,i.finalX,i.startY,i.finalY,50)}i.numTime++;if(a>=5){if((c>=0&&c<=10)||(c>=170&&c<=190)||(c>=350&&c<=360)){i.isMove=true}}else{if((c>=0&&c<=20)||(c>=160&&c<=200)||(c>=340&&c<=360)){i.isMove=true}}}var d=document.documentElement.clientWidth,h=this.aLiLen;if(i.isMove){g.preventDefault();i.moveX=i.sliderX+(f.pageX-i.startX);if(i.moveX>0){i.moveX=0}if(i.moveX<-(d*(h-1))){i.moveX=-(d*(h-1))}HeaderSlider.moving(b,i.moveX)}},endHandle:function(m){m.stopPropagation();var o=m.changedTouches[0],l=this.oBox,c=this.oDiv,s=this.aTabTitle,p=this.oDivWidth,d=this.oSiftTab,h=this.oTabs,q=this.oUl,f=this.aLiLen,r=this.oTryme,a=this.oDownloadApp,j=this.oUserAgent,n=this.oMCommonHeader,b=document.documentElement.clientWidth,k=this;l.numTime=0;l.endX=o.pageX;l.endY=o.pageY;if((l.isMove)&&(l.endX-l.startX<0)){if(Math.abs(l.endX-l.startX)>p/3){if(l.tabIndex<f-1){l.tabIndex++;document.documentElement.scrollTop=0;document.body.scrollTop=0;if(r&&j.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){r.style.display="block"}}if(a&&j.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){a.style.display="block"}}}if(k.defaults.loadInfoFn&&typeof k.defaults.loadInfoFn=="function"){k.defaults.loadInfoFn(l.tabIndex,1)}if(k.defaults.loadAssessFn&&typeof k.defaults.loadAssessFn=="function"){k.defaults.loadAssessFn(l.tabIndex,2)}l.sliderX=l.sliderX-b;if(l.sliderX<-(b*(f-1))){l.tabIndex=f-1;l.sliderX=-(b*(f-1))}HeaderSlider.sliding(q,l.sliderX);HeaderSlider.headSwitch(d,l.tabIndex,1);HeaderSlider.headSwitch(h,l.tabIndex,2);HeaderSlider.visible(d,l.tabIndex,1);k.HeightTimer();k.setHoldTopHeight();k.slideMping(l.tabIndex,"ÉÌÆ·")}else{HeaderSlider.sliding(q,l.sliderX)}}else{if((l.isMove)&&(l.endX-l.startX>0)){if(Math.abs(l.endX-l.startX)>p/3){if(l.tabIndex>0){l.tabIndex--;document.documentElement.scrollTop=0;document.body.scrollTop=0;if(r&&j.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){r.style.display="block"}}if(a&&j.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){a.style.display="block"}}}if(k.defaults.loadInfoFn&&typeof k.defaults.loadInfoFn=="function"){k.defaults.loadInfoFn(l.tabIndex,1)}if(k.defaults.loadAssessFn&&typeof k.defaults.loadAssessFn=="function"){k.defaults.loadAssessFn(l.tabIndex,2)}l.sliderX=l.sliderX+b;if(l.sliderX>0){l.sliderX=0}HeaderSlider.sliding(q,l.sliderX);HeaderSlider.headSwitch(d,l.tabIndex,1);HeaderSlider.headSwitch(h,l.tabIndex,2);HeaderSlider.visible(d,l.tabIndex,1);k.HeightTimer();k.setHoldTopHeight();k.slideMping(l.tabIndex,"ÆÀ¼Û")}else{HeaderSlider.sliding(q,l.sliderX)}}}if(n!=null){for(var g=0;g<s.length;g++){HeaderSlider.removeClass(s[g],"header-tab-selected")}HeaderSlider.addClass(s[l.tabIndex],"header-tab-selected")}c.removeEventListener("touchmove",this,false);c.removeEventListener("touchend",this,false);if(l.tabIndex==2){window.removeEventListener("scroll",this,false)}else{window.addEventListener("scroll",this,false)}},clickTab:function(){var a=this.aTabLi,d=this.oBox,c=this;for(var b=0;b<a.length;b++){(function(e){if(a[e]){a[e].onclick=function(){d.tabIndex=e;c.toTopMping(d.tabIndex);if(c.defaults.loadInfoFn&&typeof c.defaults.loadInfoFn=="function"){c.defaults.loadInfoFn(d.tabIndex,1)}if(c.defaults.loadAssessFn&&typeof c.defaults.loadAssessFn=="function"){c.defaults.loadAssessFn(d.tabIndex,2,0)}c.tabSwitch(d.tabIndex)}}})(b)}},clickInfoTab:function(){var c=this,b=document.querySelectorAll(".tab-lst-a");for(var a=0;a<b.length;a++){(function(d){if(b[d]){b[d].addEventListener("click",function(){c.HeightTimer()},false)}})(a)}},clickAssessTab:function(){var a=this,b=this.oTabs;if(b){b.addEventListener("click",function(e){var d=e||event,c=d.srcElemnt||d.target;if(c.nodeName.toLowerCase()=="p"){a.HeightTimer()}})}},tabSwitch:function(k){var g=this.aTabLi,i=this.oBox,o=this.aTabTitle,d=this.oSiftTab,f=this.oTabs,m=this.oUl,a=this.aLi,n=this.oTryme,b=this.oDownloadApp,l=this.oMCommonHeader,c=document.documentElement.clientWidth,h=this.oUserAgent;i.tabIndex=k;if(l!=null){for(var e=0;e<g.length;e++){HeaderSlider.removeClass(o[e],"header-tab-selected")}HeaderSlider.addClass(o[i.tabIndex],"header-tab-selected")}i.sliderX=-(i.tabIndex*c);HeaderSlider.sliding(m,i.sliderX);HeaderSlider.headSwitch(d,i.tabIndex,1);HeaderSlider.visible(d,i.tabIndex,1);HeaderSlider.headSwitch(f,i.tabIndex,2);this.HeightTimer();document.documentElement.scrollTop=0;document.body.scrollTop=0;if(n&&h.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){n.style.display="block"}}if(b&&h.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){b.style.display="block"}}this.setHoldTopHeight();if(HeaderSlider.hasClass(a[i.tabIndex],"reply-body")){window.removeEventListener("scroll",this,false)}else{window.addEventListener("scroll",this,false)}},windowScroll:function(){var d=this.oSiftTab,g=this.oBox,a=this.aLi,h=this,m=this.oTryme,b=this.oDownloadApp,f=this.oUserAgent,c=10,e=0,k=document.documentElement.clientHeight,l=document.querySelector(".hold-div-top").offsetHeight,j=document.querySelector(".hold-div-bottom").offsetHeight;if(document.querySelector(".cart-concern-btm-fixed")){e=document.querySelector(".cart-concern-btm-fixed").offsetHeight}else{e=0}var i=k-l-j-e;window.addEventListener("scroll",function(){if(!HeaderSlider.hasClass(a[g.tabIndex],"reply-body")){if(a[g.tabIndex].offsetHeight>i){var n=document.documentElement.scrollTop||document.body.scrollTop;if(n>=1){if(m){m.style.display="none"}if(b){b.style.display="none"}if(n>=c){c=n;if(d){d.style.visibility="hidden"}}if(n<c){c=n;if(d){d.style.visibility="visible"}}h.setHoldTopHeight()}else{if(m&&f.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){m.style.display="block"}}if(b&&f.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){b.style.display="block"}}if(d){d.style.visibility="visible"}h.setHoldTopHeight()}}else{if(d){d.style.visibility="visible"}}}},false)},assessScroll:function(){var d=this.oTabs,f=this.oBox,g=this,j=this.oTryme,b=this.oDownloadApp,e=this.oUserAgent,c=10,i=document.querySelector(".jd-header-new-bar"),h=document.querySelector("#commentListId");if(i!=null){var a=i.offsetTop}if(h){h.addEventListener("scroll",function(){var k=h.scrollTop;if(k>a){if(j){j.style.display="none"}if(b){b.style.display="none"}if(k>=c){c=k;if(d){d.style.display="none"}}if(k<c){c=k;HeaderSlider.headSwitch(d,f.tabIndex,2)}g.setHoldTopHeight()}else{if(j&&e.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){j.style.display="block"}}if(b&&e.indexOf("Html5Plus")<0){if(!HeaderSlider.getSession("isPanelClose")){b.style.display="block"}}g.setHoldTopHeight()}},false);window.removeEventListener("scroll",this,false)}},sliderJump:function(){var a=this.oBox;a.tabIndex++;if(this.defaults.loadInfoFn&&typeof this.defaults.loadInfoFn=="function"){this.defaults.loadInfoFn(a.tabIndex,1)}this.tabSwitch(a.tabIndex);this.toTopMping(a.tabIndex)},goBack:function(){var a=this.oBox;if(a.tabIndex&&a.tabIndex!==0){a.tabIndex=0;a.sliderX=0;this.tabSwitch(a.tabIndex);this.toTopMping(a.tabIndex)}else{window.history.go(-1)}},foldClick:function(){var c=document.querySelectorAll(".arrow-fold"),b=this;for(var a=0;a<c.length;a++){if(c[a]){c[a].addEventListener("click",function(){b.HeightTimer()})}}},guessSwitch:function(){var a=document.querySelectorAll(".switch-title"),c=this;for(var b=0;b<a.length;b++){if(a[b]){a[b].addEventListener("click",function(){c.HeightTimer()})}}},evaluateJump:function(){var b=this.oBox,a=this;$(".comment-list").on("click",".comment-list-item",function(){var c=$(this).find(".comment-img-container");b.tabIndex=2;a.tabSwitch(b.tabIndex);itemPingjiaFlag=false;a.toTopMping(b.tabIndex);if(c.length==0){pingClickWithLevel("MProductdetail_OnlyComment","","",$("#currentWareId").val(),"5");assessListInit({containerID:"tab-wrapper",url:"/newComments/newCommentsDetail.json",tabIndex:0,maxCount:10,cbList:useful,checkParam:$("#commendetailModel").attr("commendetail-data")})}else{assessListInit({containerID:"tab-wrapper",url:"/newComments/newCommentsDetail.json",tabIndex:4,maxCount:10,cbList:useful,checkParam:$("#commendetailModel").attr("commendetail-data")})}});$("#orderComment").on("click",function(){b.tabIndex=2;a.tabSwitch(b.tabIndex);itemPingjiaFlag=false;a.toTopMping(b.tabIndex);assessListInit({containerID:"tab-wrapper",url:"/newComments/newCommentsDetail.json",tabIndex:4,maxCount:10,cbList:useful,checkParam:$("#commendetailModel").attr("commendetail-data")})});$("#btnAssess").on("click",function(){b.tabIndex=2;a.tabSwitch(b.tabIndex);itemPingjiaFlag=false;a.toTopMping(b.tabIndex);assessListInit({containerID:"tab-wrapper",url:"/newComments/newCommentsDetail.json",tabIndex:0,maxCount:10,cbList:useful,checkParam:$("#commendetailModel").attr("commendetail-data")})});$(".detailInfoClick").on("click",function(){b.tabIndex=1;a.tabSwitch(b.tabIndex);a.toTopMping(b.tabIndex);productInfoLoad({containerID:"goodDetail",wareId:$("#currentWareId").val(),url:"/ware/detail.json?wareId="+$("#currentWareId").val(),cbfn:function(){var c=document.getElementById("scale-parent2");scale("scale-parent","scale-cont");if(c){scale("scale-parent2","scale-cont2")}}})})},appClick:function(){var c=document.querySelector(".later"),a=document.querySelector(".download-close"),b=this;if(c){c.addEventListener("click",function(){clearTimeout(d);var d=setTimeout(function(){b.setHoldTopHeight()},200)})}if(a){a.addEventListener("click",function(){clearTimeout(d);var d=setTimeout(function(){b.setHoldTopHeight()},200)})}},oJdkeyClick:function(){var b=document.getElementById("m_common_header_jdkey"),a=this;if(b!=null){b.addEventListener("click",function(){$("#m_common_header_shortcut").toggleClass("hide");a.setHoldTopHeight()})}},orientationchangeHandler:function(){var a=this.oUl,c=this.oBox;this.liInit();clearTimeout(b);var b=setTimeout(function(){var d=document.documentElement.clientWidth;c.sliderX=-(d*c.tabIndex);HeaderSlider.sliding(a,c.sliderX)},300);this.HeightTimer()},HeightTimer:function(){var b=this.oBox,a=this;if(b.tabIndex==1){clearInterval(this.setHeightTimer);this.setHeightTimer=setInterval(function(){a.setHeight()},1000);clearTimeout(this.clearHeightTimer);this.clearHeightTimer=setTimeout(function(){clearInterval(a.setHeightTimer)},60000)}else{clearInterval(this.setHeightTimer);this.setHeightTimer=setInterval(function(){a.setHeight()},800);clearTimeout(this.clearHeightTimer);this.clearHeightTimer=setTimeout(function(){clearInterval(a.setHeightTimer)},2500)}},toTop:function(){var a=document.getElementById("indexToTop"),b=this.oSiftTab,c=this.oTabs,d=this.oBox;if(a){a.addEventListener("click",function(){HeaderSlider.visible(b,d.tabIndex,1);HeaderSlider.headSwitch(c,d.tabIndex,2)},false)}},toTopMping:function(b){var a=$("#indexToTop");switch(b){case 0:a.attr("report-eventid","MProductdetail_BackToTop");break;case 1:a.attr("report-eventid","MProductdetail_DetailBackToTop");break;case 2:a.attr("report-eventid","MProductdetail_CommentBackToTop");break}},slideMping:function(b,a){var c=this.oBox;if(b==0){pingClickWithLevel("MProductdetail_ProductTabSlide","","",$("#currentWareId").val(),"5")}else{if(b==1){pingClickWithLevel("MProductdetail_DetailTabSlide",a,"",$("#currentWareId").val(),"5")}else{if(b==2){pingClickWithLevel("MProductdetail_CommentTabSlide","","",$("#currentWareId").val(),"5")}}}this.toTopMping(c.tabIndex)}};HeaderSlider.extend=function(c,b){for(var a in b){if(b[a]!==undefined){c[a]=b[a]}}};HeaderSlider.extend(HeaderSlider,{setStyle:function(c,b){for(var a in b){c.style[a]=b[a]}},getStyle:function(b,a){return(b.currentStyle||getComputedStyle(b,false))[a]},hasClass:function(b,a){if(b){return b.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))}},addClass:function(b,a){if(!HeaderSlider.hasClass(b,a)){b.className+=" "+a}},removeClass:function(c,a){if(HeaderSlider.hasClass(c,a)){var b=new RegExp("(\\s|^)"+a+"(\\s|$)");c.className=c.className.replace(b," ")}},sliding:function(b,a){HeaderSlider.setStyle(b,{WebkitTransition:"500ms ease",transition:"500ms ease"});HeaderSlider.setStyle(b,{WebkitTransform:"translate3d("+a+"px,0,0)",transform:"translate3d("+a+"px,0,0)"})},moving:function(b,a){HeaderSlider.setStyle(b,{transform:"translate3d("+a+"px,0,0)",WebkitTransform:"translate3d("+a+"px,0,0)"})},headSwitch:function(c,a,b){if(c!=null){if(a==b){c.style.display="block"}else{c.style.display="none"}}},visible:function(c,a,b){if(c!=null){if(a==b){c.style.visibility="visible"}else{c.style.visibility="hidden"}}},getAngle:function(c,b,e,d){var a=Math.abs(c-b);var h=Math.abs(e-d);var g=Math.sqrt(a*a+h*h);var f=Math.round((Math.asin(h/g)/Math.PI*180));if(b>=c&&d<=e){f=f}else{if(b<=c&&d<=e){f=180-f}else{if(b<=c&&d>=e){f=180+f}else{if(b>=c&&d>=e){f=360-f}}}}return f},getSpeed:function(b,a,h,g,d){var i=Math.abs(b-a);var f=Math.abs(h-g);var e=Math.sqrt(i*i+f*f);var c=e/d;return c},pingClick:function(g,d,c,a){try{if($("#pingUse").val()){var f=new MPing.inputs.Click(g);f.event_param=d;f.page_param=a;var b=new MPing();b.send(f)}}catch(h){}},pingClickWithLevel:function(h,d,c,a,g){try{if($("#pingUse").val()){var f=new MPing.inputs.Click(h);f.event_param=d;f.page_param=a;f.event_level=g;var b=new MPing();b.send(f)}}catch(i){}},getSession:function(a){var c=window.sessionStorage;if(c){var b=c.getItem(a);if(b){if(b=="true"){return true}}}return false}});